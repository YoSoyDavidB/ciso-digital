# Malware Incident Response Playbook

## Metadata
- **Incident Type**: Malware
- **Severity Range**: Medium to Critical
- **Framework References**: NIST SP 800-61 Rev. 2, ISO/IEC 27035
- **Last Updated**: February 2026
- **Version**: 1.0

---

## Executive Summary

This playbook provides a structured approach to responding to malware incidents, including viruses, trojans, ransomware, rootkits, and other malicious software. The goal is to rapidly contain, eradicate, and recover from malware infections while minimizing business impact and preventing further spread.

**Key Objectives:**
- Contain malware spread within 15 minutes of detection
- Preserve forensic evidence for investigation
- Eradicate malware completely from all affected systems
- Restore operations with verified clean systems
- Prevent recurrence through lessons learned

---

## Triggers (When to Use This Playbook)

Use this playbook when:
- âœ… Antivirus/EDR alerts indicate malware detection
- âœ… System exhibits unusual behavior (CPU spikes, network traffic, file encryption)
- âœ… Security tools detect known malware signatures or hashes
- âœ… User reports suspicious executable or system behavior
- âœ… Threat intelligence indicates active malware campaign targeting organization
- âœ… Files encrypted with ransom note present
- âœ… Unauthorized processes or services detected

---

## Incident Response Phases

### Phase 1: Detection & Analysis (Time: 0-30 minutes)

#### Step 1.1: Initial Triage (5 minutes)
**Objective**: Rapidly assess the incident scope and severity.

**Actions**:
1. Document initial detection source and time
2. Identify affected system(s):
   - Hostname/IP address
   - Operating system
   - Business criticality
   - Network segment
3. Capture initial indicators:
   - Malware name/family (if known)
   - File hashes (MD5, SHA-256)
   - File paths
   - Process names
   - Network connections (IP addresses, domains)
4. Determine severity based on:
   - Number of affected systems
   - System criticality
   - Malware type (ransomware = critical)
   - Data at risk

**Output**: Initial incident ticket with severity classification

---

#### Step 1.2: Evidence Collection (10 minutes)
**Objective**: Preserve forensic evidence before containment actions.

**Actions**:
1. **Memory Capture** (if possible before isolation):
   ```bash
   # Windows: Use FTK Imager or WinPMEM
   # Linux: Use LiME or dd
   ```
2. **Network Evidence**:
   - Capture active network connections: `netstat -anob` (Windows) or `ss -tulpn` (Linux)
   - Export firewall/IDS logs for the last 24 hours
3. **Disk Evidence**:
   - List running processes: `tasklist /v` (Windows) or `ps aux` (Linux)
   - Capture recent file modifications: `dir /o-d /s` (Windows) or `find / -mtime -1` (Linux)
   - Export security event logs
4. **Take system snapshot** (VM) or disk image (physical)

**Output**: Forensic evidence package stored in secure location

---

#### Step 1.3: Malware Analysis - Initial (15 minutes)
**Objective**: Understand malware behavior and identify IOCs.

**Actions**:
1. **Static Analysis**:
   - Submit file hash to VirusTotal, Hybrid Analysis
   - Check known malware databases
   - Identify file type, packer, obfuscation
2. **Behavioral Indicators**:
   - Registry modifications (Windows)
   - Scheduled tasks/cron jobs
   - Persistence mechanisms
   - Lateral movement attempts
3. **Network IOCs**:
   - Command & Control (C2) servers
   - Suspicious domains/IPs
   - Data exfiltration attempts
4. **Document findings** in incident ticket

**Output**: IOC list for hunting and blocking

---

### Phase 2: Containment (Time: 30-45 minutes)

#### Step 2.1: Immediate Containment (5 minutes) ðŸš¨ CRITICAL
**Objective**: Stop malware spread immediately.

**Actions**:
1. **Isolate infected system(s)**:
   - Disconnect network cable (physical systems)
   - Disable network adapter (VMs)
   - Block MAC address at switch level
   - **DO NOT** shut down (preserves memory evidence)
2. **Block malware IOCs network-wide**:
   - Add C2 domains/IPs to firewall blacklist
   - Update IDS/IPS signatures
   - Block file hashes at email gateway and web proxy
3. **Disable compromised user accounts**:
   - Reset passwords for affected user(s)
   - Disable account in Active Directory
   - Revoke authentication tokens
4. **Alert Security Team**: Notify SOC, CISO, IT leadership

**Output**: Infected systems isolated, IOCs blocked

---

#### Step 2.2: Lateral Movement Check (20 minutes)
**Objective**: Identify and contain additional infected systems.

**Actions**:
1. **Hunt for IOCs across environment**:
   - Search for file hashes on all endpoints (EDR query)
   - Check for suspicious processes across fleet
   - Scan for network connections to C2 servers
   - Review authentication logs for lateral movement
2. **Check domain controller logs**:
   - Failed authentication attempts
   - Privilege escalation attempts
   - New user/group creation
3. **Scan network segments**:
   - Run IOC scans on file servers
   - Check database servers for suspicious activity
   - Review backup systems for infection
4. **Isolate additional systems** if malware detected

**Output**: Complete list of all affected systems

---

#### Step 2.3: Short-Term Containment (20 minutes)
**Objective**: Implement controls to prevent re-infection during remediation.

**Actions**:
1. **Network Segmentation**:
   - Move infected systems to isolated VLAN
   - Implement micro-segmentation rules
   - Block inter-segment communication temporarily
2. **Email Protection**:
   - Block sender domains/addresses at email gateway
   - Quarantine similar emails in all mailboxes
   - Send user awareness alert
3. **Patch Management**:
   - Identify exploited vulnerability (if applicable)
   - Emergency patch deployment for vulnerable systems
4. **Backup Verification**:
   - Verify backups are clean and not encrypted
   - Isolate backup systems from infected network

**Output**: Environment secured against re-infection

---

### Phase 3: Eradication (Time: 45-120 minutes)

#### Step 3.1: Malware Removal (30 minutes per system)
**Objective**: Completely remove malware from affected systems.

**Actions**:
1. **Automated Removal** (try first):
   - Run updated antivirus/EDR full scan
   - Use vendor-specific removal tools
   - Execute remediation scripts
2. **Manual Removal** (if automated fails):
   - Kill malicious processes
   - Delete malicious files
   - Remove registry keys (Windows)
   - Delete scheduled tasks/cron jobs
   - Remove persistence mechanisms
3. **Verify Removal**:
   - Re-scan with multiple AV engines
   - Check process list
   - Verify no C2 communication
4. **For Ransomware**: Consider full system rebuild instead of cleaning

**Output**: Clean systems verified with multiple scans

---

#### Step 3.2: Credential Reset (15 minutes)
**Objective**: Eliminate attacker access via stolen credentials.

**Actions**:
1. **Reset passwords for**:
   - Affected user accounts
   - Service accounts used on infected systems
   - Administrator/root accounts
   - Application passwords stored on system
2. **Revoke certificates and tokens**:
   - API keys
   - OAuth tokens
   - SSL/TLS certificates (if compromised)
3. **Enable MFA** for affected accounts (if not already enabled)

**Output**: All credentials rotated, access re-secured

---

#### Step 3.3: Vulnerability Remediation (30 minutes)
**Objective**: Fix the initial infection vector.

**Actions**:
1. **Identify root cause**:
   - Phishing email (user training needed)
   - Unpatched vulnerability (emergency patching)
   - Weak credentials (password policy update)
   - Misconfiguration (security hardening)
2. **Apply fixes**:
   - Deploy patches
   - Harden configurations
   - Update security policies
   - Implement additional controls
3. **Validate fixes**:
   - Vulnerability scan
   - Penetration testing (if time permits)

**Output**: Initial attack vector closed

---

### Phase 4: Recovery (Time: 2-8 hours)

#### Step 4.1: System Restoration (varies by system)
**Objective**: Restore affected systems to normal operations.

**Actions**:
1. **Choose restoration method**:
   - **Option A**: Clean system, restore from backup
   - **Option B**: Rebuild system from scratch (preferred for critical infections)
   - **Option C**: Re-image system with golden image
2. **Restore from Backup** (if Option A):
   - Verify backup is clean (pre-infection timestamp)
   - Restore system and data
   - Apply all patches before reconnecting to network
3. **Rebuild System** (if Option B):
   - Install OS from verified media
   - Apply all patches and updates
   - Install and configure applications
   - Restore data from clean backup
4. **Security Hardening**:
   - Enable EDR/AV with latest signatures
   - Configure firewall rules
   - Enable audit logging
   - Disable unnecessary services
   - Apply CIS benchmarks

**Output**: Clean, hardened systems ready for production

---

#### Step 4.2: Validation Testing (30 minutes)
**Objective**: Verify systems are clean and functional.

**Actions**:
1. **Security Validation**:
   - Full AV/EDR scan (clean result)
   - IOC hunt (no detections)
   - Network traffic analysis (no C2 communication)
   - Log review (no suspicious activity)
2. **Functional Testing**:
   - Application functionality
   - User access
   - Network connectivity
   - Performance baseline
3. **Monitoring Setup**:
   - Enhanced logging enabled
   - SIEM alerts configured
   - EDR monitoring active
   - Network flow monitoring

**Output**: Systems validated clean and functional

---

#### Step 4.3: Phased Reconnection (1 hour)
**Objective**: Safely return systems to production.

**Actions**:
1. **Stage 1: Isolated Testing** (15 min)
   - Keep system in isolated VLAN
   - Test all functions in isolation
   - Monitor for 15 minutes
2. **Stage 2: Limited Production** (30 min)
   - Connect to production network
   - Limit user access to IT staff only
   - Monitor all network traffic
   - Watch for anomalies
3. **Stage 3: Full Production** (15 min)
   - Restore full user access
   - Resume normal operations
   - Continue enhanced monitoring for 48 hours
4. **User Communication**:
   - Notify users of restored service
   - Provide security awareness guidance

**Output**: Systems fully operational in production

---

### Phase 5: Post-Incident Activities (Time: 1-3 days)

#### Step 5.1: Lessons Learned Meeting (2 hours)
**Objective**: Identify improvements to prevent recurrence.

**Participants**: SOC team, IT operations, affected business units, management

**Agenda**:
1. **Incident Timeline Review**:
   - What happened?
   - When did it happen?
   - How was it detected?
   - What was the impact?
2. **Response Effectiveness**:
   - What went well?
   - What could be improved?
   - Were there delays? Why?
   - Were resources adequate?
3. **Root Cause Analysis**:
   - How did malware enter the environment?
   - Why did existing controls fail?
   - What vulnerabilities were exploited?
4. **Action Items**:
   - Technical improvements needed
   - Process improvements
   - Training requirements
   - Budget requests

**Output**: Lessons learned document with action items

---

#### Step 5.2: IOC Distribution (1 hour)
**Objective**: Share threat intelligence with community.

**Actions**:
1. **Internal Sharing**:
   - Update threat intelligence platform
   - Distribute IOCs to all security teams
   - Update SIEM correlation rules
   - Enhance EDR detection rules
2. **External Sharing** (if appropriate):
   - Submit to MISP, OTX, VirusTotal
   - Notify industry ISACs
   - Share with government CERT
   - Consider blog post for awareness
3. **Documentation**:
   - Complete incident report
   - Update threat intelligence database
   - Document malware analysis findings

**Output**: IOCs shared, detection improved

---

#### Step 5.3: Remediation Follow-Up (ongoing)
**Objective**: Implement long-term improvements.

**Actions**:
1. **Security Controls**:
   - Deploy additional endpoint protection
   - Implement application whitelisting
   - Enhance email filtering
   - Deploy deception technology
2. **User Awareness**:
   - Security training for affected users
   - Phishing simulation campaign
   - Update security awareness materials
3. **Process Improvements**:
   - Update detection rules
   - Refine response procedures
   - Improve communication channels
   - Enhance forensic capabilities
4. **Monitoring**:
   - Enhanced monitoring for 30 days
   - Weekly threat hunting for similar IOCs
   - Review detection efficacy

**Output**: Long-term security improvements implemented

---

## Incident Response Checklist

### âœ… Detection & Analysis
- [ ] Incident documented in ticketing system
- [ ] Affected systems identified and documented
- [ ] Initial severity assessment completed
- [ ] Memory/disk forensic images captured
- [ ] Network traffic captured
- [ ] Event logs exported
- [ ] Malware sample collected securely
- [ ] IOCs extracted and documented
- [ ] VirusTotal/sandbox analysis completed
- [ ] Stakeholders notified (SOC, CISO, IT)

### âœ… Containment
- [ ] Infected systems isolated from network
- [ ] C2 domains/IPs blocked at firewall
- [ ] File hashes blocked at endpoints
- [ ] Compromised user accounts disabled
- [ ] Lateral movement check completed
- [ ] Additional infected systems identified
- [ ] All affected systems isolated
- [ ] Network segmentation implemented
- [ ] Email sender blocked
- [ ] Backup systems verified clean

### âœ… Eradication
- [ ] Malware removed from all systems (verified with multiple tools)
- [ ] Persistence mechanisms removed
- [ ] Scheduled tasks/cron jobs cleaned
- [ ] Registry cleaned (Windows)
- [ ] All affected user passwords reset
- [ ] Service account passwords reset
- [ ] Admin passwords reset
- [ ] MFA enabled for affected accounts
- [ ] Root cause identified
- [ ] Vulnerability patched
- [ ] Security hardening applied

### âœ… Recovery
- [ ] Systems restored from clean backup OR rebuilt
- [ ] All patches applied
- [ ] Security tools installed and updated
- [ ] Full AV/EDR scan completed (clean)
- [ ] IOC hunt completed (no detections)
- [ ] Network traffic validated (no C2)
- [ ] Functional testing completed
- [ ] Enhanced monitoring configured
- [ ] Systems reconnected in phases
- [ ] Users notified of service restoration

### âœ… Post-Incident
- [ ] Lessons learned meeting conducted
- [ ] Incident report completed
- [ ] IOCs shared internally
- [ ] IOCs shared externally (if appropriate)
- [ ] Threat intelligence platform updated
- [ ] Detection rules updated
- [ ] Action items assigned with owners
- [ ] Security training scheduled
- [ ] Process improvements documented
- [ ] Enhanced monitoring in place for 30 days

---

## Key Roles and Responsibilities

| Role | Responsibilities |
|------|-----------------|
| **Incident Commander** | Overall incident coordination, decision making, stakeholder communication |
| **SOC Analyst** | Detection, triage, initial analysis, IOC extraction, monitoring |
| **Forensics Analyst** | Evidence collection, malware analysis, root cause investigation |
| **IT Operations** | System isolation, patching, rebuilding, restoration |
| **Network Engineer** | Network isolation, firewall rules, traffic analysis |
| **CISO** | Executive decisions, legal/regulatory coordination, resource allocation |
| **Communications** | Internal/external communications, user notifications |
| **Legal** | Regulatory notification requirements, law enforcement coordination |

---

## Time Estimates by Severity

| Severity | Detection | Containment | Eradication | Recovery | Total |
|----------|-----------|-------------|-------------|----------|-------|
| **Low** (1-5 systems) | 30 min | 30 min | 1 hour | 2 hours | ~4 hours |
| **Medium** (6-20 systems) | 45 min | 1 hour | 2 hours | 4 hours | ~8 hours |
| **High** (21-50 systems) | 1 hour | 2 hours | 4 hours | 8 hours | ~15 hours |
| **Critical** (50+ systems or ransomware) | 2 hours | 4 hours | 8 hours | 24+ hours | ~2-5 days |

---

## Escalation Criteria

Escalate to **CRITICAL** and invoke additional resources if:
- ðŸš¨ Ransomware detected with active encryption
- ðŸš¨ More than 50 systems infected
- ðŸš¨ Critical business systems affected (production databases, payment systems)
- ðŸš¨ Data exfiltration detected
- ðŸš¨ Malware on domain controller or backup systems
- ðŸš¨ Advanced persistent threat (APT) suspected
- ðŸš¨ Unable to contain spread after 2 hours
- ðŸš¨ Business operations significantly disrupted

---

## References and Resources

### Frameworks
- **NIST SP 800-61 Rev. 2**: Computer Security Incident Handling Guide (Section 3.2.6 - Malware Incidents)
- **ISO/IEC 27035:2023**: Information security incident management
- **SANS Incident Handler's Handbook**: Malware Incident Response

### Tools
- **Analysis**: VirusTotal, Hybrid Analysis, Any.Run, Joe Sandbox
- **Forensics**: FTK Imager, Volatility, Autopsy, KAPE
- **EDR/AV**: CrowdStrike, SentinelOne, Microsoft Defender
- **Network**: Wireshark, Zeek, Suricata, NetworkMiner

### Threat Intelligence
- **MITRE ATT&CK**: Malware tactics and techniques
- **VirusTotal Intelligence**: Malware analysis and IOCs
- **AlienVault OTX**: Open threat exchange
- **MISP**: Malware Information Sharing Platform

### Additional Playbooks
- Ransomware Incident Playbook (for ransomware-specific procedures)
- Data Exfiltration Playbook (if data theft detected)
- Advanced Persistent Threat (APT) Playbook (for sophisticated attacks)

---

## Document Control

| Version | Date | Author | Changes |
|---------|------|--------|---------|
| 1.0 | Feb 2026 | Security Team | Initial version |

---

**END OF PLAYBOOK**

**Remember**: Speed is critical in malware incidents. Contain first, investigate later. Every minute of delay allows malware to spread further.

**Emergency Contact**: SOC Hotline: [INSERT NUMBER] | Email: soc@company.com | Slack: #security-incidents
